// mkc.c - Makes machine code definitions for inclusion in the secure_memory project.


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <ctype.h>
#include <stdint.h>
#include <inttypes.h>
#include <limits.h>
#include <float.h>
#include <sys/types.h> 
#include <sys/timeb.h>


#include "../config.h"


#if defined(SEC_OS_WINDOWS)
#define WIN32_LEAN_AND_MEAN 1
#include <time.h>
#include <process.h>
#include <windows.h>
#define getpid _getpid
#define time _time64
#define gettid GetCurrentThreadId
#elif defined(SEC_OS_LINUX)
#include <time.h>
#include <sys/time.h>
#include <sys/types.h>
#include <unistd.h>
#endif


static uint8_t sm_have_rdrand[] = { 0x53, 0xB8, 0x01, 0x00, 0x00, 0x00, 0x0F, 0xA2, 0x0F, 0xBA, 0xE1, 0x1E, 0x73, 0x09, 0x48, 0xC7, 0xC0, 0x01, 0x00, 0x00, 0x00, 0x5B, 0xC3, 0x48, 0x2B, 0xC0, 0xEB, 0xF2 };
static uint8_t sm_rdrand[] = { 0x48, 0x0F, 0xC7, 0xF0, 0x73, 0xFA, 0xC3 };
static uint8_t sm_fishman_20_64_seed[] = { 0x4C, 0x8B, 0xC2, 0x4C, 0x8B, 0xC9, 0x48, 0xB8, 0x05, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0xB9, 0x01, 0x00, 0x00, 0x00, 0x48, 0xF7, 0xE2, 0x49, 0x8B, 0xC0, 0x48, 0x2B, 0xC2, 0x48, 0xD1, 0xE8, 0x48, 0x03, 0xC2, 0x48, 0xC1, 0xE8, 0x1E, 0x48, 0x69, 0xC0, 0xFF, 0xFF, 0xFF, 0x7F, 0x4C, 0x3B, 0xC0, 0x49, 0x0F, 0x45, 0xC8, 0x0F, 0xBA, 0xF1, 0x1F, 0x49, 0x89, 0x09, 0xC3 };
static uint8_t sm_fishman_20_64_rand[] = { 0x4C, 0x8B, 0xC9, 0x49, 0xBA, 0x69, 0xD8, 0x3B, 0x4C, 0xC8, 0x89, 0x47, 0x5E, 0x49, 0x8B, 0xC2, 0x48, 0xF7, 0x21, 0x48, 0x69, 0x09, 0x8F, 0xBC, 0x00, 0x00, 0x48, 0xC1, 0xEA, 0x0E, 0x48, 0x69, 0xC2, 0xFF, 0xFF, 0xFF, 0x7F, 0x48, 0x2B, 0xC8, 0x79, 0x0C, 0x48, 0x8D, 0x81, 0xFF, 0xFF, 0xFF, 0x7F, 0x49, 0x89, 0x01, 0xEB, 0x03, 0x49, 0x89, 0x09, 0x45, 0x8B, 0x01, 0x49, 0x8B, 0xC2, 0x49, 0xF7, 0x21, 0x48, 0xC1, 0xEA, 0x0E, 0x48, 0x69, 0xC2, 0xFF, 0xFF, 0xFF, 0x7F, 0x49, 0x69, 0x11, 0x8F, 0xBC, 0x00, 0x00, 0x48, 0x2B, 0xD0, 0x79, 0x0C, 0x48, 0x8D, 0x82, 0xFF, 0xFF, 0xFF, 0x7F, 0x49, 0x89, 0x01, 0xEB, 0x03, 0x49, 0x89, 0x11, 0x49, 0x8B, 0x09, 0x48, 0x8D, 0x04, 0x8D, 0x00, 0x00, 0x00, 0x00, 0x44, 0x33, 0xC0, 0x49, 0x8B, 0xC2, 0x48, 0xF7, 0xE1, 0x44, 0x89, 0x44, 0x24, 0x08, 0x48, 0xC1, 0xEA, 0x0E, 0x48, 0x69, 0xC2, 0xFF, 0xFF, 0xFF, 0x7F, 0x48, 0x69, 0xD1, 0x8F, 0xBC, 0x00, 0x00, 0x48, 0x2B, 0xD0, 0x79, 0x0C, 0x48, 0x8D, 0x82, 0xFF, 0xFF, 0xFF, 0x7F, 0x49, 0x89, 0x01, 0xEB, 0x03, 0x49, 0x89, 0x11, 0x45, 0x8B, 0x01, 0x49, 0x8B, 0xC2, 0x49, 0xF7, 0x21, 0x48, 0xC1, 0xEA, 0x0E, 0x48, 0x69, 0xC2, 0xFF, 0xFF, 0xFF, 0x7F, 0x49, 0x69, 0x11, 0x8F, 0xBC, 0x00, 0x00, 0x48, 0x2B, 0xD0, 0x79, 0x1C, 0x48, 0x8D, 0x82, 0xFF, 0xFF, 0xFF, 0x7F, 0x49, 0x89, 0x01, 0x48, 0xC1, 0xE0, 0x02, 0x44, 0x33, 0xC0, 0x44, 0x89, 0x44, 0x24, 0x0C, 0x48, 0x8B, 0x44, 0x24, 0x08, 0xC3, 0x48, 0x8B, 0xC2, 0x49, 0x89, 0x11, 0x48, 0xC1, 0xE0, 0x02, 0x44, 0x33, 0xC0, 0x44, 0x89, 0x44, 0x24, 0x0C, 0x48, 0x8B, 0x44, 0x24, 0x08, 0xC3 };
static uint8_t sm_knuth_2002_64_shift_seed[] = { 0x48, 0x89, 0x5C, 0x24, 0x08, 0x48, 0x89, 0x74, 0x24, 0x10, 0x57, 0x48, 0x81, 0xEC, 0x40, 0x06, 0x00, 0x00, 0x48, 0x85, 0xD2, 0x48, 0x8D, 0x99, 0x8C, 0x1F, 0x00, 0x00, 0x41, 0xB9, 0x2F, 0xCB, 0x04, 0x00, 0x48, 0x8B, 0xF9, 0x4C, 0x0F, 0x45, 0xCA, 0x49, 0x8D, 0x51, 0x02, 0x81, 0xE2, 0xFE, 0xFF, 0xFF, 0x3F, 0x33, 0xF6, 0x44, 0x8B, 0xC6, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4A, 0x89, 0x14, 0xC4, 0x48, 0x8D, 0x04, 0x12, 0x49, 0xFF, 0xC0, 0x48, 0x8D, 0x90, 0x02, 0x00, 0x00, 0xC0, 0x48, 0x3D, 0x00, 0x00, 0x00, 0x40, 0x48, 0x0F, 0x42, 0xD0, 0x49, 0x83, 0xF8, 0x64, 0x7C, 0xDE, 0x48, 0xFF, 0x44, 0x24, 0x08, 0x41, 0xBA, 0x45, 0x00, 0x00, 0x00, 0x41, 0x81, 0xE1, 0xFF, 0xFF, 0xFF, 0x3F, 0x0F, 0x1F, 0x40, 0x00, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x94, 0x24, 0x08, 0x03, 0x00, 0x00, 0x41, 0xB8, 0x21, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x84, 0x24, 0x20, 0x06, 0x00, 0x00, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8B, 0x4A, 0x10, 0x48, 0x8D, 0x52, 0xE8, 0x48, 0x89, 0x48, 0x10, 0x48, 0x89, 0x70, 0x08, 0x48, 0x8D, 0x40, 0xD0, 0x48, 0x8B, 0x4A, 0x20, 0x48, 0x89, 0x48, 0x30, 0x48, 0x89, 0x70, 0x28, 0x48, 0x8B, 0x4A, 0x18, 0x48, 0x89, 0x48, 0x20, 0x48, 0x89, 0x70, 0x18, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xCE, 0x48, 0x8D, 0x94, 0x24, 0x10, 0x03, 0x00, 0x00, 0x41, 0xB8, 0x63, 0x00, 0x00, 0x00, 0x48, 0x8B, 0x8A, 0x20, 0x03, 0x00, 0x00, 0x48, 0x8B, 0x82, 0x28, 0x01, 0x00, 0x00, 0x48, 0x8D, 0x52, 0xF8, 0x48, 0x2B, 0xC1, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x82, 0x30, 0x01, 0x00, 0x00, 0x48, 0x8B, 0x42, 0x08, 0x48, 0x2B, 0xC1, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0x08, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xC9, 0x41, 0xF6, 0xC1, 0x01, 0x74, 0x50, 0x48, 0x8D, 0x8C, 0x24, 0x18, 0x03, 0x00, 0x00, 0x41, 0x8D, 0x50, 0x32, 0x0F, 0x1F, 0x80, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8B, 0x01, 0x48, 0x89, 0x41, 0x08, 0x48, 0x8B, 0x41, 0xF8, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0xF0, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE8, 0x48, 0x8B, 0x84, 0x24, 0x20, 0x03, 0x00, 0x00, 0x48, 0x8B, 0x8C, 0x24, 0x28, 0x01, 0x00, 0x00, 0x48, 0x2B, 0xC8, 0x48, 0x89, 0x04, 0x24, 0x81, 0xE1, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x8C, 0x24, 0x28, 0x01, 0x00, 0x00, 0x4D, 0x85, 0xC9, 0x74, 0x05, 0x49, 0xD1, 0xF9, 0xEB, 0x03, 0x41, 0xFF, 0xCA, 0x45, 0x85, 0xD2, 0x0F, 0x85, 0xFD, 0xFE, 0xFF, 0xFF, 0x48, 0x8D, 0x8B, 0xF8, 0x01, 0x00, 0x00, 0x48, 0x8D, 0x14, 0x24, 0x45, 0x8D, 0x42, 0x09, 0x48, 0x8B, 0x02, 0x48, 0x8D, 0x52, 0x20, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x20, 0x48, 0x8B, 0x42, 0xE8, 0x48, 0x89, 0x41, 0xE8, 0x48, 0x8B, 0x42, 0xF0, 0x48, 0x89, 0x41, 0xF0, 0x48, 0x8B, 0x42, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xD4, 0x48, 0x8B, 0x02, 0x41, 0xB8, 0x0F, 0x00, 0x00, 0x00, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x94, 0x24, 0x28, 0x01, 0x00, 0x00, 0x48, 0x8B, 0xCB, 0x66, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8B, 0x02, 0x48, 0x8D, 0x52, 0x20, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x20, 0x48, 0x8B, 0x42, 0xE8, 0x48, 0x89, 0x41, 0xE8, 0x48, 0x8B, 0x42, 0xF0, 0x48, 0x89, 0x41, 0xF0, 0x48, 0x8B, 0x42, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xD4, 0x48, 0x8B, 0x02, 0x4C, 0x8D, 0x94, 0x24, 0x18, 0x03, 0x00, 0x00, 0x48, 0x89, 0x01, 0x45, 0x8D, 0x58, 0x0A, 0x48, 0x8B, 0x42, 0x08, 0x4C, 0x2B, 0xD3, 0x48, 0x89, 0x41, 0x08, 0x48, 0x8B, 0x42, 0x10, 0x48, 0x89, 0x41, 0x10, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x0C, 0x24, 0x48, 0x8B, 0xD3, 0x41, 0xB8, 0x19, 0x00, 0x00, 0x00, 0x0F, 0x1F, 0x00, 0x48, 0x8B, 0x02, 0x48, 0x8D, 0x52, 0x20, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x20, 0x48, 0x8B, 0x42, 0xE8, 0x48, 0x89, 0x41, 0xE8, 0x48, 0x8B, 0x42, 0xF0, 0x48, 0x89, 0x41, 0xF0, 0x48, 0x8B, 0x42, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xD4, 0x48, 0x8D, 0x8C, 0x24, 0xF8, 0x01, 0x00, 0x00, 0x41, 0x8D, 0x50, 0x21, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x8B, 0x81, 0x08, 0xFE, 0xFF, 0xFF, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x18, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x81, 0x10, 0x01, 0x00, 0x00, 0x8B, 0x81, 0xF8, 0xFD, 0xFF, 0xFF, 0x2B, 0x41, 0xF0, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x81, 0x18, 0x01, 0x00, 0x00, 0x8B, 0x81, 0x00, 0xFE, 0xFF, 0xFF, 0x2B, 0x41, 0xF8, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x81, 0x20, 0x01, 0x00, 0x00, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xB8, 0x41, 0xB8, 0xA2, 0x00, 0x00, 0x00, 0x48, 0x8B, 0xD3, 0x45, 0x8D, 0x48, 0x83, 0x66, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0x0C, 0x12, 0x48, 0x8D, 0x52, 0x08, 0x41, 0x8B, 0xC0, 0x41, 0xFF, 0xC0, 0x2B, 0x0C, 0xC4, 0x81, 0xE1, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x4A, 0xF8, 0x49, 0x83, 0xE9, 0x01, 0x75, 0xDF, 0x4C, 0x8D, 0x84, 0x24, 0x40, 0x04, 0x00, 0x00, 0x48, 0x8B, 0xCB, 0x4C, 0x2B, 0xC3, 0x41, 0x8D, 0x51, 0x3F, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0x04, 0x08, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x08, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x81, 0x20, 0x01, 0x00, 0x00, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE4, 0x49, 0x83, 0xEB, 0x01, 0x0F, 0x85, 0xEA, 0xFE, 0xFF, 0xFF, 0x4C, 0x8D, 0x9C, 0x24, 0x40, 0x06, 0x00, 0x00, 0x89, 0x37, 0x49, 0x8B, 0x5B, 0x10, 0x49, 0x8B, 0x73, 0x18, 0x49, 0x8B, 0xE3, 0x5F, 0xC3 };
static uint8_t sm_knuth_2002_64_shift_rand[] = { 0x48, 0x89, 0x5C, 0x24, 0x18, 0x48, 0x89, 0x6C, 0x24, 0x20, 0x48, 0x89, 0x4C, 0x24, 0x08, 0x56, 0x57, 0x41, 0x54, 0x41, 0x55, 0x41, 0x56, 0x41, 0x57, 0x8B, 0x31, 0x4C, 0x8D, 0x49, 0x04, 0xBD, 0xCC, 0x03, 0x00, 0x00, 0x41, 0xBC, 0x32, 0x00, 0x00, 0x00, 0x41, 0xBA, 0x2F, 0x01, 0x00, 0x00, 0x45, 0x8D, 0x7C, 0x24, 0xF3, 0x44, 0x8D, 0x6D, 0x4A, 0x85, 0xF6, 0x0F, 0x85, 0x13, 0x01, 0x00, 0x00, 0x4D, 0x8D, 0x81, 0x88, 0x1F, 0x00, 0x00, 0x41, 0x8B, 0xD4, 0x4D, 0x2B, 0xC1, 0x49, 0x8D, 0x49, 0x08, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x49, 0x8B, 0x44, 0x08, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x8B, 0x04, 0x08, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x10, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE6, 0x49, 0x8D, 0x91, 0x30, 0x03, 0x00, 0x00, 0x4D, 0x8B, 0xC2, 0x49, 0x8D, 0x89, 0xF8, 0x01, 0x00, 0x00, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x8B, 0x81, 0x08, 0xFE, 0xFF, 0xFF, 0x48, 0x8D, 0x52, 0x18, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x18, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xD8, 0x8B, 0x81, 0xF8, 0xFD, 0xFF, 0xFF, 0x2B, 0x41, 0xF0, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE0, 0x8B, 0x81, 0x00, 0xFE, 0xFF, 0xFF, 0x2B, 0x41, 0xF8, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xBD, 0x44, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xDF, 0x45, 0x8B, 0xD7, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0xC0, 0x41, 0x8D, 0x48, 0xC1, 0x41, 0x8B, 0x14, 0xC9, 0x4D, 0x8D, 0x5B, 0x08, 0x41, 0xFF, 0xC0, 0x41, 0x2B, 0x14, 0xC1, 0x81, 0xE2, 0xFF, 0xFF, 0xFF, 0x3F, 0x49, 0x89, 0x53, 0xF8, 0x48, 0x83, 0xEB, 0x01, 0x75, 0xDA, 0x45, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0xB0, 0x20, 0x00, 0x00, 0x41, 0x8D, 0x40, 0x9C, 0x41, 0x8B, 0x04, 0xC1, 0x41, 0x8D, 0x4A, 0xDB, 0x41, 0x2B, 0x84, 0xC9, 0x88, 0x1F, 0x00, 0x00, 0x4D, 0x8D, 0x5B, 0x08, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x45, 0x8D, 0x40, 0x01, 0x41, 0xFF, 0xC2, 0x49, 0x89, 0x43, 0xF8, 0x41, 0x83, 0xFA, 0x64, 0x72, 0xD2, 0x41, 0xBA, 0x2F, 0x01, 0x00, 0x00, 0x4D, 0x8B, 0x34, 0xF1, 0xB8, 0x1F, 0x85, 0xEB, 0x51, 0xFF, 0xC6, 0xF7, 0xE6, 0xC1, 0xEA, 0x05, 0x6B, 0xC2, 0x64, 0x2B, 0xF0, 0x48, 0x8B, 0x44, 0x24, 0x38, 0x89, 0x30, 0x0F, 0x85, 0x08, 0x01, 0x00, 0x00, 0x4D, 0x8D, 0x81, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xD4, 0x4D, 0x2B, 0xC1, 0x49, 0x8D, 0x49, 0x08, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x49, 0x8B, 0x44, 0x08, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x8B, 0x04, 0x08, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x10, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE6, 0x49, 0x8D, 0x91, 0x30, 0x03, 0x00, 0x00, 0x4D, 0x8B, 0xC2, 0x49, 0x8D, 0x89, 0xF8, 0x01, 0x00, 0x00, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x8B, 0x81, 0x08, 0xFE, 0xFF, 0xFF, 0x48, 0x8D, 0x52, 0x18, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x18, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xD8, 0x8B, 0x81, 0xF8, 0xFD, 0xFF, 0xFF, 0x2B, 0x41, 0xF0, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE0, 0x8B, 0x81, 0x00, 0xFE, 0xFF, 0xFF, 0x2B, 0x41, 0xF8, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xBD, 0x44, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xDF, 0x45, 0x8B, 0xD7, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0xC0, 0x41, 0x8D, 0x48, 0xC1, 0x41, 0x8B, 0x14, 0xC9, 0x4D, 0x8D, 0x5B, 0x08, 0x41, 0xFF, 0xC0, 0x41, 0x2B, 0x14, 0xC1, 0x81, 0xE2, 0xFF, 0xFF, 0xFF, 0x3F, 0x49, 0x89, 0x53, 0xF8, 0x48, 0x83, 0xEB, 0x01, 0x75, 0xDA, 0x45, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0xB0, 0x20, 0x00, 0x00, 0x41, 0x8D, 0x40, 0x9C, 0x41, 0x8B, 0x04, 0xC1, 0x41, 0x8D, 0x4A, 0xDB, 0x41, 0x2B, 0x84, 0xC9, 0x88, 0x1F, 0x00, 0x00, 0x4D, 0x8D, 0x5B, 0x08, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x45, 0x8D, 0x40, 0x01, 0x41, 0xFF, 0xC2, 0x49, 0x89, 0x43, 0xF8, 0x41, 0x83, 0xFA, 0x64, 0x72, 0xD2, 0x49, 0x8B, 0x0C, 0xF1, 0xB8, 0x1F, 0x85, 0xEB, 0x51, 0xFF, 0xC6, 0xF7, 0xE6, 0xC1, 0xEA, 0x05, 0x6B, 0xC2, 0x64, 0x2B, 0xF0, 0x48, 0x8B, 0x44, 0x24, 0x38, 0x89, 0x30, 0x48, 0x8D, 0x04, 0x8D, 0x00, 0x00, 0x00, 0x00, 0x41, 0x33, 0xC6, 0x89, 0x44, 0x24, 0x40, 0x85, 0xF6, 0x0F, 0x85, 0x0D, 0x01, 0x00, 0x00, 0x4D, 0x8D, 0x81, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xD4, 0x4D, 0x2B, 0xC1, 0x49, 0x8D, 0x49, 0x08, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x49, 0x8B, 0x44, 0x08, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x8B, 0x04, 0x08, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x10, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE6, 0x49, 0x8D, 0x91, 0x30, 0x03, 0x00, 0x00, 0x41, 0xB8, 0x2F, 0x01, 0x00, 0x00, 0x49, 0x8D, 0x89, 0xF8, 0x01, 0x00, 0x00, 0x66, 0x90, 0x8B, 0x81, 0x08, 0xFE, 0xFF, 0xFF, 0x48, 0x8D, 0x52, 0x18, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x18, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xD8, 0x8B, 0x81, 0xF8, 0xFD, 0xFF, 0xFF, 0x2B, 0x41, 0xF0, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE0, 0x8B, 0x81, 0x00, 0xFE, 0xFF, 0xFF, 0x2B, 0x41, 0xF8, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xBD, 0x44, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xDF, 0x45, 0x8B, 0xD7, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0xC0, 0x41, 0x8D, 0x48, 0xC1, 0x41, 0x8B, 0x14, 0xC9, 0x4D, 0x8D, 0x5B, 0x08, 0x41, 0xFF, 0xC0, 0x41, 0x2B, 0x14, 0xC1, 0x81, 0xE2, 0xFF, 0xFF, 0xFF, 0x3F, 0x49, 0x89, 0x53, 0xF8, 0x48, 0x83, 0xEB, 0x01, 0x75, 0xDA, 0x45, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0xB0, 0x20, 0x00, 0x00, 0x41, 0x8D, 0x40, 0x9C, 0x41, 0x8B, 0x04, 0xC1, 0x41, 0x8D, 0x4A, 0xDB, 0x41, 0x2B, 0x84, 0xC9, 0x88, 0x1F, 0x00, 0x00, 0x4D, 0x8D, 0x5B, 0x08, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x45, 0x8D, 0x40, 0x01, 0x41, 0xFF, 0xC2, 0x49, 0x89, 0x43, 0xF8, 0x41, 0x83, 0xFA, 0x64, 0x72, 0xD2, 0x4D, 0x8B, 0x34, 0xF1, 0xB8, 0x1F, 0x85, 0xEB, 0x51, 0xFF, 0xC6, 0xF7, 0xE6, 0xC1, 0xEA, 0x05, 0x6B, 0xC2, 0x64, 0x2B, 0xF0, 0x48, 0x8B, 0x44, 0x24, 0x38, 0x89, 0x30, 0x0F, 0x85, 0x0E, 0x01, 0x00, 0x00, 0x4D, 0x8D, 0x81, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xD4, 0x4D, 0x2B, 0xC1, 0x49, 0x8D, 0x49, 0x08, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x49, 0x8B, 0x44, 0x08, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x49, 0x8B, 0x04, 0x08, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x10, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE6, 0x49, 0x8D, 0x91, 0x30, 0x03, 0x00, 0x00, 0x41, 0xB8, 0x2F, 0x01, 0x00, 0x00, 0x49, 0x8D, 0x89, 0xF8, 0x01, 0x00, 0x00, 0x66, 0x90, 0x8B, 0x81, 0x08, 0xFE, 0xFF, 0xFF, 0x48, 0x8D, 0x52, 0x18, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x18, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xD8, 0x8B, 0x81, 0xF8, 0xFD, 0xFF, 0xFF, 0x2B, 0x41, 0xF0, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE0, 0x8B, 0x81, 0x00, 0xFE, 0xFF, 0xFF, 0x2B, 0x41, 0xF8, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xBD, 0x44, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x8B, 0xDF, 0x45, 0x8B, 0xD7, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0xC0, 0x41, 0x8D, 0x48, 0xC1, 0x41, 0x8B, 0x14, 0xC9, 0x4D, 0x8D, 0x5B, 0x08, 0x41, 0xFF, 0xC0, 0x41, 0x2B, 0x14, 0xC1, 0x81, 0xE2, 0xFF, 0xFF, 0xFF, 0x3F, 0x49, 0x89, 0x53, 0xF8, 0x48, 0x83, 0xEB, 0x01, 0x75, 0xDA, 0x45, 0x8B, 0xC5, 0x4D, 0x8D, 0x99, 0xB0, 0x20, 0x00, 0x00, 0x41, 0x8D, 0x40, 0x9C, 0x41, 0x8B, 0x04, 0xC1, 0x41, 0x8D, 0x4A, 0xDB, 0x41, 0x2B, 0x84, 0xC9, 0x88, 0x1F, 0x00, 0x00, 0x4D, 0x8D, 0x5B, 0x08, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x45, 0x8D, 0x40, 0x01, 0x41, 0xFF, 0xC2, 0x49, 0x89, 0x43, 0xF8, 0x41, 0x83, 0xFA, 0x64, 0x72, 0xD2, 0x49, 0x8B, 0x0C, 0xF1, 0x8D, 0x7E, 0x01, 0x48, 0x8B, 0x74, 0x24, 0x38, 0xB8, 0x1F, 0x85, 0xEB, 0x51, 0xF7, 0xE7, 0xC1, 0xEA, 0x05, 0x6B, 0xC2, 0x64, 0x2B, 0xF8, 0x48, 0x8D, 0x04, 0x8D, 0x00, 0x00, 0x00, 0x00, 0x41, 0x33, 0xC6, 0x89, 0x3E, 0x89, 0x44, 0x24, 0x44, 0x85, 0xFF, 0x0F, 0x85, 0xEE, 0x00, 0x00, 0x00, 0x49, 0x8D, 0x91, 0x88, 0x1F, 0x00, 0x00, 0x49, 0x2B, 0xD1, 0x49, 0x8D, 0x49, 0x08, 0x48, 0x8B, 0x44, 0x0A, 0xF8, 0x48, 0x89, 0x41, 0xF8, 0x48, 0x8B, 0x04, 0x0A, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x10, 0x49, 0x83, 0xEC, 0x01, 0x75, 0xE6, 0x49, 0x8D, 0x91, 0x30, 0x03, 0x00, 0x00, 0xBB, 0x2F, 0x01, 0x00, 0x00, 0x49, 0x8D, 0x89, 0xF8, 0x01, 0x00, 0x00, 0x0F, 0x1F, 0x00, 0x8B, 0x81, 0x08, 0xFE, 0xFF, 0xFF, 0x48, 0x8D, 0x52, 0x18, 0x2B, 0x01, 0x48, 0x8D, 0x49, 0x18, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xD8, 0x8B, 0x81, 0xF8, 0xFD, 0xFF, 0xFF, 0x2B, 0x41, 0xF0, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE0, 0x8B, 0x81, 0x00, 0xFE, 0xFF, 0xFF, 0x2B, 0x41, 0xF8, 0x25, 0xFF, 0xFF, 0xFF, 0x3F, 0x48, 0x89, 0x42, 0xE8, 0x48, 0x83, 0xEB, 0x01, 0x75, 0xBD, 0x4D, 0x8D, 0x81, 0x88, 0x1F, 0x00, 0x00, 0x45, 0x8B, 0xD7, 0x0F, 0x1F, 0x00, 0x8B, 0xC5, 0x8D, 0x4D, 0xC1, 0x41, 0x8B, 0x14, 0xC9, 0x4D, 0x8D, 0x40, 0x08, 0xFF, 0xC5, 0x41, 0x2B, 0x14, 0xC1, 0x81, 0xE2, 0xFF, 0xFF, 0xFF, 0x3F, 0x49, 0x89, 0x50, 0xF8, 0x49, 0x83, 0xEF, 0x01, 0x75, 0xDD, 0x4D, 0x8D, 0x99, 0xB0, 0x20, 0x00, 0x00, 0x66, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x41, 0x8D, 0x55, 0x9C, 0x45, 0x8B, 0x04, 0xD1, 0x41, 0x8D, 0x42, 0xDB, 0x45, 0x2B, 0x84, 0xC1, 0x88, 0x1F, 0x00, 0x00, 0x4D, 0x8D, 0x5B, 0x08, 0x41, 0x81, 0xE0, 0xFF, 0xFF, 0xFF, 0x3F, 0x45, 0x8D, 0x6D, 0x01, 0x41, 0xFF, 0xC2, 0x4D, 0x89, 0x43, 0xF8, 0x41, 0x83, 0xFA, 0x64, 0x72, 0xD0, 0x4D, 0x8B, 0x04, 0xF9, 0x8D, 0x4F, 0x01, 0x48, 0x8B, 0x5C, 0x24, 0x48, 0xB8, 0x1F, 0x85, 0xEB, 0x51, 0x48, 0x8B, 0x6C, 0x24, 0x50, 0xF7, 0xE1, 0xC1, 0xEA, 0x05, 0x6B, 0xC2, 0x64, 0x2B, 0xC8, 0x48, 0x8B, 0x44, 0x24, 0x40, 0x89, 0x0E, 0x41, 0x8D, 0x48, 0x01, 0x83, 0xE1, 0x3F, 0x48, 0xD3, 0xE8, 0x41, 0x5F, 0x41, 0x5E, 0x41, 0x5D, 0x41, 0x5C, 0x5F, 0x5E, 0xC3 };
static uint8_t sm_lecuyer_32_seed[] = { 0x4C, 0x8B, 0xCA, 0x49, 0xBB, 0xC5, 0xC8, 0x03, 0x00, 0xF2, 0x01, 0x00, 0x00, 0x4C, 0x8B, 0xD1, 0x49, 0x8B, 0xC3, 0x48, 0xF7, 0xE2, 0x4D, 0x8B, 0xC1, 0x49, 0x8B, 0xC3, 0x4C, 0x2B, 0xC2, 0x49, 0xD1, 0xE8, 0x4C, 0x03, 0xC2, 0x49, 0xC1, 0xE8, 0x1E, 0x49, 0x69, 0xC8, 0x07, 0xFF, 0xFF, 0x7F, 0x41, 0xB8, 0x01, 0x00, 0x00, 0x00, 0x4C, 0x3B, 0xC9, 0x4D, 0x0F, 0x45, 0xC1, 0x49, 0xF7, 0xE0, 0x49, 0x8B, 0xC0, 0x48, 0x2B, 0xC2, 0x48, 0xD1, 0xE8, 0x48, 0x03, 0xC2, 0x48, 0xC1, 0xE8, 0x1E, 0x48, 0x69, 0xC0, 0x07, 0xFF, 0xFF, 0x7F, 0x4C, 0x2B, 0xC0, 0x4D, 0x89, 0x02, 0xC3 };
static uint8_t sm_lecuyer_32_rand[] = { 0xB8, 0xCD, 0x09, 0x7A, 0x4F, 0xF7, 0x29, 0xC1, 0xFA, 0x0E, 0x8B, 0xC2, 0xC1, 0xE8, 0x1F, 0x03, 0xD0, 0x69, 0xC2, 0x07, 0xFF, 0xFF, 0x7F, 0x69, 0x11, 0xF4, 0x9E, 0x00, 0x00, 0x2B, 0xD0, 0x8D, 0x82, 0x07, 0xFF, 0xFF, 0x7F, 0x0F, 0x49, 0xC2, 0x48, 0x98, 0x48, 0x89, 0x01, 0xC3 };
static uint8_t sm_gfsr4_32_seed[] = { 0x48, 0x89, 0x5C, 0x24, 0x08, 0x48, 0x89, 0x74, 0x24, 0x10, 0x48, 0x89, 0x7C, 0x24, 0x18, 0x83, 0xCB, 0xFF, 0x41, 0xBA, 0x05, 0x11, 0x00, 0x00, 0x48, 0x85, 0xD2, 0x48, 0x8B, 0xF1, 0x41, 0xB8, 0x00, 0x00, 0x00, 0x80, 0x4C, 0x0F, 0x45, 0xD2, 0x45, 0x33, 0xDB, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x33, 0xC0, 0x45, 0x8B, 0xC8, 0x8D, 0x78, 0x10, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x49, 0x69, 0xCA, 0xCD, 0x0D, 0x01, 0x00, 0x41, 0x8B, 0xD1, 0x0B, 0xD0, 0x49, 0x23, 0xC8, 0x0F, 0x44, 0xD0, 0x41, 0xD1, 0xE9, 0x49, 0x69, 0xC2, 0x29, 0x76, 0x58, 0x1C, 0x8B, 0xC8, 0x44, 0x8B, 0xD0, 0x8B, 0xC2, 0x41, 0x0B, 0xC1, 0x49, 0x23, 0xC8, 0x0F, 0x44, 0xC2, 0x41, 0xD1, 0xE9, 0x48, 0x83, 0xEF, 0x01, 0x75, 0xCB, 0x42, 0x89, 0x44, 0x9E, 0x04, 0x49, 0xFF, 0xC3, 0x49, 0x81, 0xFB, 0xFF, 0x3F, 0x00, 0x00, 0x7E, 0xAA, 0x48, 0x8D, 0x4E, 0x20, 0x8D, 0x57, 0x20, 0x0F, 0x1F, 0x00, 0x8B, 0xC3, 0xD1, 0xEB, 0x23, 0x01, 0x48, 0x8D, 0x49, 0x0C, 0x41, 0x0B, 0xC0, 0x41, 0xD1, 0xE8, 0x89, 0x41, 0xF4, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xE7, 0x48, 0x8B, 0x5C, 0x24, 0x08, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0xC7, 0x06, 0x20, 0x00, 0x00, 0x00, 0x48, 0x8B, 0x74, 0x24, 0x10, 0xC3 };
static uint8_t sm_gfsr4_32_rand[] = { 0x8B, 0x01, 0x4C, 0x8D, 0x49, 0x04, 0xFF, 0xC0, 0x25, 0xFF, 0x3F, 0x00, 0x00, 0x44, 0x8B, 0xC0, 0x44, 0x89, 0x01, 0x8D, 0x88, 0x27, 0x1A, 0x00, 0x00, 0x05, 0xB4, 0xE4, 0xFF, 0xFF, 0x81, 0xE1, 0xFF, 0x3F, 0x00, 0x00, 0x25, 0xFF, 0x3F, 0x00, 0x00, 0x41, 0x8B, 0x14, 0x89, 0x41, 0x8D, 0x88, 0xCE, 0xF9, 0xFF, 0xFF, 0x41, 0x33, 0x14, 0x81, 0x81, 0xE1, 0xFF, 0x3F, 0x00, 0x00, 0x41, 0x33, 0x14, 0x89, 0x41, 0x8D, 0x88, 0x29, 0xFE, 0xFF, 0xFF, 0x81, 0xE1, 0xFF, 0x3F, 0x00, 0x00, 0x41, 0x33, 0x14, 0x89, 0x43, 0x89, 0x14, 0x81, 0x8B, 0xC2, 0xC3 };
static uint8_t sm_splitmix_64_seed[] = { 0x48, 0x89, 0x11, 0xC3 };
static uint8_t sm_splitmix_64_rand[] = { 0x48, 0xB8, 0x15, 0x7C, 0x4A, 0x7F, 0xB9, 0x79, 0x37, 0x9E, 0x48, 0x01, 0x01, 0x48, 0x8B, 0x01, 0x48, 0x8B, 0xC8, 0x48, 0xC1, 0xE9, 0x1E, 0x48, 0x33, 0xC8, 0x48, 0xB8, 0xB9, 0xE5, 0xE4, 0x1C, 0x6D, 0x47, 0x58, 0xBF, 0x48, 0x0F, 0xAF, 0xC8, 0x48, 0xB8, 0xEB, 0x11, 0x31, 0x13, 0xBB, 0x49, 0xD0, 0x94, 0x48, 0x8B, 0xD1, 0x48, 0xC1, 0xEA, 0x1B, 0x48, 0x33, 0xD1, 0x48, 0x0F, 0xAF, 0xD0, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x1F, 0x48, 0x33, 0xC2, 0xC3 };
static uint8_t sm_xoroshiro_128_64_seed[] = { 0x48, 0x89, 0x5C, 0x24, 0x08, 0x4C, 0x8B, 0xC1, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x1E, 0x48, 0xB9, 0xB9, 0xE5, 0xE4, 0x1C, 0x6D, 0x47, 0x58, 0xBF, 0x48, 0x33, 0xC2, 0x45, 0x33, 0xC9, 0x48, 0x0F, 0xAF, 0xC1, 0x48, 0xB9, 0xEB, 0x11, 0x31, 0x13, 0xBB, 0x49, 0xD0, 0x94, 0x45, 0x8B, 0xD1, 0x49, 0x89, 0x00, 0x48, 0xBB, 0xCB, 0xFA, 0xA5, 0xEB, 0x67, 0x04, 0xAC, 0xBE, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x1B, 0x48, 0x33, 0xC2, 0x48, 0x0F, 0xAF, 0xC1, 0x45, 0x32, 0xDB, 0x49, 0x89, 0x40, 0x08, 0x4C, 0x0F, 0xA3, 0xDB, 0x73, 0x06, 0x4D, 0x33, 0x08, 0x4C, 0x33, 0xD0, 0x49, 0x8B, 0x10, 0x41, 0xFE, 0xC3, 0x48, 0x33, 0xC2, 0x48, 0xC1, 0xCA, 0x09, 0x48, 0x8B, 0xC8, 0x48, 0xC1, 0xE1, 0x0E, 0x48, 0x33, 0xD1, 0x48, 0x33, 0xD0, 0x48, 0xC1, 0xC8, 0x1C, 0x49, 0x89, 0x10, 0x41, 0x80, 0xFB, 0x40, 0x72, 0xCD, 0x49, 0x89, 0x40, 0x08, 0x45, 0x32, 0xDB, 0x48, 0xBB, 0x22, 0x99, 0xAA, 0x86, 0x8B, 0x04, 0x6B, 0xD8, 0x4C, 0x0F, 0xA3, 0xDB, 0x73, 0x06, 0x4D, 0x33, 0x08, 0x4C, 0x33, 0xD0, 0x49, 0x8B, 0x10, 0x41, 0xFE, 0xC3, 0x48, 0x33, 0xC2, 0x48, 0xC1, 0xCA, 0x09, 0x48, 0x8B, 0xC8, 0x48, 0xC1, 0xE1, 0x0E, 0x48, 0x33, 0xD1, 0x48, 0x33, 0xD0, 0x48, 0xC1, 0xC8, 0x1C, 0x49, 0x89, 0x10, 0x41, 0x80, 0xFB, 0x40, 0x72, 0xCD, 0x48, 0x8B, 0x5C, 0x24, 0x08, 0x4D, 0x89, 0x08, 0x4D, 0x89, 0x50, 0x08, 0xC3 };
static uint8_t sm_xoroshiro_128_64_rand[] = { 0x4C, 0x8B, 0x01, 0x4C, 0x8B, 0x49, 0x08, 0x4B, 0x8D, 0x04, 0x01, 0x4D, 0x33, 0xC8, 0x49, 0x8B, 0xD1, 0x49, 0xC1, 0xC8, 0x09, 0x48, 0xC1, 0xE2, 0x0E, 0x4C, 0x33, 0xC2, 0x4D, 0x33, 0xC1, 0x49, 0xC1, 0xC9, 0x1C, 0x4C, 0x89, 0x49, 0x08, 0x4C, 0x89, 0x01, 0xC3 };
static uint8_t sm_xorshift_1024_64_seed[] = { 0x48, 0x83, 0xEC, 0x08, 0x4C, 0x8D, 0x41, 0x04, 0x48, 0x85, 0xC9, 0x74, 0x6E, 0x48, 0x89, 0x1C, 0x24, 0x41, 0xB9, 0x10, 0x00, 0x00, 0x00, 0x48, 0xBB, 0xEB, 0x11, 0x31, 0x13, 0xBB, 0x49, 0xD0, 0x94, 0xC7, 0x01, 0x00, 0x00, 0x00, 0x00, 0x49, 0xBA, 0xEB, 0x83, 0xB5, 0x80, 0x46, 0x86, 0xC8, 0x61, 0x49, 0xBB, 0xB9, 0xE5, 0xE4, 0x1C, 0x6D, 0x47, 0x58, 0xBF, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x49, 0x2B, 0xD2, 0x4D, 0x8D, 0x40, 0x08, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x1E, 0x48, 0x33, 0xC2, 0x49, 0x0F, 0xAF, 0xC3, 0x48, 0x8B, 0xC8, 0x48, 0xC1, 0xE9, 0x1B, 0x48, 0x33, 0xC8, 0x48, 0x0F, 0xAF, 0xCB, 0x48, 0x8B, 0xC1, 0x48, 0xC1, 0xE8, 0x1F, 0x48, 0x33, 0xC1, 0x49, 0x89, 0x40, 0xF8, 0x49, 0x83, 0xE9, 0x01, 0x75, 0xC9, 0x48, 0x8B, 0x1C, 0x24, 0x48, 0x83, 0xC4, 0x08, 0xC3 };
static uint8_t sm_xorshift_1024_64_rand[] = { 0x48, 0x63, 0x11, 0x4C, 0x8B, 0x4C, 0xD1, 0x04, 0x8D, 0x42, 0x01, 0x83, 0xE0, 0x0F, 0x8B, 0xD0, 0x4C, 0x8D, 0x04, 0xC1, 0x89, 0x11, 0x49, 0x8B, 0x50, 0x04, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE0, 0x1F, 0x48, 0x33, 0xD0, 0x49, 0x8B, 0xC1, 0x48, 0xC1, 0xE8, 0x13, 0x48, 0x33, 0xC2, 0x48, 0xC1, 0xE8, 0x0B, 0x48, 0x33, 0xC2, 0x48, 0xBA, 0x13, 0x7C, 0x4A, 0x7F, 0xB9, 0x79, 0x37, 0x9E, 0x49, 0x33, 0xC1, 0x49, 0x89, 0x40, 0x04, 0x48, 0x63, 0x01, 0x48, 0x8B, 0x44, 0xC1, 0x04, 0x48, 0x0F, 0xAF, 0xC2, 0xC3 };
static uint8_t sm_mersenne_64_seed[] = { 0x48, 0x89, 0x51, 0x04, 0x48, 0x8D, 0x41, 0x0C, 0x41, 0xB9, 0x01, 0x00, 0x00, 0x00, 0x41, 0xBA, 0x37, 0x01, 0x00, 0x00, 0x49, 0xBB, 0x2D, 0x7F, 0x95, 0x4C, 0x2D, 0xF4, 0x51, 0x58, 0x66, 0x90, 0x4C, 0x8B, 0x40, 0xF8, 0x48, 0x8D, 0x40, 0x08, 0x49, 0xC1, 0xE8, 0x3E, 0x4C, 0x33, 0x40, 0xF0, 0x4D, 0x0F, 0xAF, 0xC3, 0x4D, 0x03, 0xC1, 0x49, 0xFF, 0xC1, 0x4C, 0x89, 0x40, 0xF8, 0x49, 0x83, 0xEA, 0x01, 0x75, 0xDC, 0x44, 0x89, 0x11, 0xC3 };
static uint8_t sm_mersenne_64_rand[] = { 0x48, 0x83, 0xEC, 0x18, 0x48, 0xB8, 0xE9, 0x19, 0x66, 0xA9, 0x5A, 0x6F, 0x02, 0xB5, 0x48, 0xC7, 0x04, 0x24, 0x00, 0x00, 0x00, 0x00, 0x48, 0x89, 0x44, 0x24, 0x08, 0x4C, 0x8B, 0xD1, 0x8B, 0x01, 0x3D, 0x38, 0x01, 0x00, 0x00, 0x0F, 0x8C, 0x1C, 0x01, 0x00, 0x00, 0x3D, 0x39, 0x01, 0x00, 0x00, 0x75, 0x55, 0x48, 0xC7, 0x41, 0x04, 0x71, 0x15, 0x00, 0x00, 0x48, 0x8D, 0x51, 0x0C, 0x41, 0xB8, 0x01, 0x00, 0x00, 0x00, 0x44, 0x8D, 0x48, 0xFE, 0x49, 0xBB, 0x2D, 0x7F, 0x95, 0x4C, 0x2D, 0xF4, 0x51, 0x58, 0x0F, 0x1F, 0x40, 0x00, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8B, 0x4A, 0xF8, 0x48, 0x8D, 0x52, 0x08, 0x48, 0xC1, 0xE9, 0x3E, 0x48, 0x33, 0x4A, 0xF0, 0x49, 0x0F, 0xAF, 0xCB, 0x49, 0x03, 0xC8, 0x49, 0xFF, 0xC0, 0x48, 0x89, 0x4A, 0xF8, 0x49, 0x83, 0xE9, 0x01, 0x75, 0xDC, 0x45, 0x89, 0x0A, 0x45, 0x33, 0xC9, 0x41, 0xB8, 0x9C, 0x00, 0x00, 0x00, 0x43, 0x8B, 0x54, 0xCA, 0x0C, 0x43, 0x33, 0x54, 0xCA, 0x04, 0x0F, 0xBA, 0xF2, 0x1F, 0x4B, 0x33, 0x54, 0xCA, 0x04, 0x48, 0x8B, 0xC2, 0x48, 0xD1, 0xEA, 0x83, 0xE0, 0x01, 0x48, 0x8B, 0x0C, 0xC4, 0x48, 0x33, 0xCA, 0x4B, 0x33, 0x8C, 0xCA, 0xE4, 0x04, 0x00, 0x00, 0x4B, 0x89, 0x4C, 0xCA, 0x04, 0x49, 0xFF, 0xC1, 0x4D, 0x3B, 0xC8, 0x7C, 0xC8, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43, 0x8B, 0x54, 0xC2, 0x0C, 0x43, 0x33, 0x54, 0xC2, 0x04, 0x0F, 0xBA, 0xF2, 0x1F, 0x4B, 0x33, 0x54, 0xC2, 0x04, 0x48, 0x8B, 0xC2, 0x48, 0xD1, 0xEA, 0x83, 0xE0, 0x01, 0x48, 0x8B, 0x0C, 0xC4, 0x48, 0x33, 0xCA, 0x4B, 0x33, 0x8C, 0xC2, 0x24, 0xFB, 0xFF, 0xFF, 0x4B, 0x89, 0x4C, 0xC2, 0x04, 0x49, 0xFF, 0xC0, 0x49, 0x81, 0xF8, 0x37, 0x01, 0x00, 0x00, 0x7C, 0xC4, 0x41, 0x8B, 0x52, 0x04, 0x41, 0x33, 0x92, 0xBC, 0x09, 0x00, 0x00, 0x0F, 0xBA, 0xF2, 0x1F, 0x49, 0x33, 0x92, 0xBC, 0x09, 0x00, 0x00, 0x48, 0x8B, 0xC2, 0x48, 0xD1, 0xEA, 0x83, 0xE0, 0x01, 0x48, 0x8B, 0x0C, 0xC4, 0x49, 0x33, 0x8A, 0xDC, 0x04, 0x00, 0x00, 0x48, 0x33, 0xCA, 0x49, 0x89, 0x8A, 0xBC, 0x09, 0x00, 0x00, 0x41, 0xC7, 0x02, 0x00, 0x00, 0x00, 0x00, 0x49, 0x63, 0x0A, 0x49, 0xB8, 0x55, 0x55, 0x55, 0x55, 0x05, 0x00, 0x00, 0x00, 0x49, 0x8B, 0x54, 0xCA, 0x04, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x1D, 0x49, 0x23, 0xC0, 0x49, 0xB8, 0xD3, 0xF6, 0xFF, 0x3F, 0xEB, 0x38, 0x00, 0x00, 0x48, 0x33, 0xD0, 0x48, 0x8B, 0xC2, 0x49, 0x23, 0xC0, 0x48, 0xC1, 0xE0, 0x11, 0x48, 0x33, 0xD0, 0x48, 0x8B, 0xC2, 0x48, 0x25, 0x77, 0xBF, 0xFF, 0xFF, 0x48, 0xC1, 0xE0, 0x25, 0x48, 0x33, 0xD0, 0x8D, 0x41, 0x01, 0x41, 0x89, 0x02, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x2B, 0x48, 0x33, 0xC2, 0x48, 0x83, 0xC4, 0x18, 0xC3 };
static uint8_t COMPRESS[] = { 0x4C, 0x89, 0x44, 0x24, 0x18, 0x55, 0x41, 0x55, 0x41, 0x56, 0x48, 0x83, 0xEC, 0x10, 0x4D, 0x8B, 0xE9, 0x48, 0x8D, 0x2C, 0x11, 0x4D, 0x8B, 0xC8, 0x4C, 0x8B, 0xF1, 0x4C, 0x8B, 0xD1, 0x4D, 0x85, 0xED, 0x0F, 0x84, 0xAF, 0x02, 0x00, 0x00, 0x49, 0x8B, 0x45, 0x00, 0x4C, 0x89, 0x64, 0x24, 0x08, 0x4C, 0x8B, 0x64, 0x24, 0x50, 0x4C, 0x89, 0x3C, 0x24, 0x4D, 0x8D, 0x3C, 0x00, 0x4D, 0x85, 0xE4, 0x75, 0x15, 0x4C, 0x8B, 0x64, 0x24, 0x08, 0xB0, 0x03, 0x4C, 0x8B, 0x3C, 0x24, 0x48, 0x83, 0xC4, 0x10, 0x41, 0x5E, 0x41, 0x5D, 0x5D, 0xC3, 0x48, 0x89, 0x74, 0x24, 0x38, 0x4D, 0x85, 0xF6, 0x75, 0x12, 0x48, 0x85, 0xD2, 0x75, 0x12, 0x33, 0xF6, 0x49, 0x89, 0x75, 0x00, 0x32, 0xC0, 0xE9, 0xFB, 0x01, 0x00, 0x00, 0x4D, 0x85, 0xC9, 0x75, 0x07, 0xB0, 0x03, 0xE9, 0xEF, 0x01, 0x00, 0x00, 0x33, 0xC0, 0x48, 0x89, 0x5C, 0x24, 0x30, 0x48, 0x89, 0x7C, 0x24, 0x48, 0x49, 0x8D, 0x56, 0x02, 0x33, 0xF6, 0x49, 0x8B, 0xFC, 0xB9, 0x00, 0x00, 0x08, 0x00, 0x44, 0x8B, 0xC6, 0xF3, 0xAA, 0x41, 0x0F, 0xB6, 0x3E, 0x49, 0x8D, 0x41, 0x01, 0x41, 0x0F, 0xB6, 0x4E, 0x01, 0xC1, 0xE7, 0x08, 0x48, 0x0B, 0xF9, 0x48, 0x3B, 0xD5, 0x0F, 0x83, 0x9F, 0x01, 0x00, 0x00, 0x66, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x0F, 0xB6, 0x0A, 0x48, 0xC1, 0xE7, 0x08, 0x48, 0x0B, 0xF9, 0x48, 0x8B, 0xCF, 0x48, 0xC1, 0xE9, 0x08, 0x48, 0x2B, 0xCF, 0x0F, 0xB7, 0xC9, 0x4D, 0x8B, 0x0C, 0xCC, 0x4D, 0x89, 0x14, 0xCC, 0x4D, 0x3B, 0xCA, 0x0F, 0x83, 0x36, 0x01, 0x00, 0x00, 0x4D, 0x8B, 0xDA, 0x4D, 0x2B, 0xD9, 0x49, 0xFF, 0xCB, 0x49, 0x81, 0xFB, 0x00, 0x20, 0x00, 0x00, 0x0F, 0x83, 0x20, 0x01, 0x00, 0x00, 0x49, 0x8D, 0x4A, 0x04, 0x48, 0x3B, 0xCD, 0x0F, 0x83, 0x13, 0x01, 0x00, 0x00, 0x4D, 0x3B, 0xCE, 0x0F, 0x86, 0x0A, 0x01, 0x00, 0x00, 0x41, 0x0F, 0xB6, 0x0A, 0x41, 0x38, 0x09, 0x0F, 0x85, 0xFD, 0x00, 0x00, 0x00, 0x41, 0x0F, 0xB6, 0x4A, 0x01, 0x41, 0x38, 0x49, 0x01, 0x0F, 0x85, 0xEE, 0x00, 0x00, 0x00, 0x0F, 0xB6, 0x0A, 0x41, 0x38, 0x49, 0x02, 0x0F, 0x85, 0xE1, 0x00, 0x00, 0x00, 0xB9, 0x08, 0x01, 0x00, 0x00, 0x48, 0x8B, 0xDD, 0x49, 0x2B, 0xDA, 0x48, 0x8B, 0xD0, 0x48, 0x83, 0xC3, 0xFE, 0xBF, 0x03, 0x00, 0x00, 0x00, 0x48, 0x3B, 0xD9, 0x48, 0x0F, 0x4F, 0xD9, 0x48, 0x8B, 0xCE, 0x4D, 0x85, 0xC0, 0x0F, 0x94, 0xC1, 0x48, 0x2B, 0xD1, 0x48, 0x8D, 0x4A, 0x04, 0x49, 0x3B, 0xCF, 0x0F, 0x83, 0xEE, 0x00, 0x00, 0x00, 0x49, 0x2B, 0xC0, 0x41, 0x8D, 0x48, 0xFF, 0x88, 0x48, 0xFF, 0x48, 0x8B, 0xC2, 0x48, 0x3B, 0xFB, 0x73, 0x1E, 0x49, 0x8D, 0x52, 0x03, 0x4D, 0x2B, 0xCA, 0x0F, 0x1F, 0x00, 0x0F, 0xB6, 0x0A, 0x41, 0x38, 0x0C, 0x11, 0x75, 0x0B, 0x48, 0xFF, 0xC7, 0x48, 0xFF, 0xC2, 0x48, 0x3B, 0xFB, 0x72, 0xEC, 0x49, 0x8B, 0xCB, 0x48, 0x83, 0xEF, 0x02, 0x48, 0xC1, 0xE9, 0x08, 0x48, 0x83, 0xFF, 0x07, 0x73, 0x10, 0x40, 0x0F, 0xB6, 0xD7, 0xC0, 0xE2, 0x05, 0x02, 0xD1, 0x88, 0x10, 0x48, 0xFF, 0xC0, 0xEB, 0x0F, 0x80, 0xE9, 0x20, 0x88, 0x08, 0x8D, 0x4F, 0xF9, 0x88, 0x48, 0x01, 0x48, 0x83, 0xC0, 0x02, 0x49, 0xFF, 0xC2, 0x44, 0x88, 0x18, 0x4C, 0x03, 0xD7, 0x48, 0x83, 0xC0, 0x02, 0x4C, 0x8B, 0xC6, 0x49, 0x8D, 0x4A, 0x03, 0x48, 0x3B, 0xCD, 0x73, 0x64, 0x41, 0x0F, 0xB6, 0x3A, 0x41, 0x0F, 0xB6, 0x4A, 0x01, 0xC1, 0xE7, 0x08, 0x48, 0x0B, 0xF9, 0x41, 0x0F, 0xB6, 0x4A, 0x02, 0x48, 0xC1, 0xE7, 0x08, 0x48, 0x0B, 0xF9, 0x48, 0x8B, 0xCF, 0x48, 0xC1, 0xE9, 0x08, 0x48, 0x2B, 0xCF, 0x0F, 0xB7, 0xC9, 0x4D, 0x89, 0x14, 0xCC, 0x49, 0xFF, 0xC2, 0xEB, 0x24, 0x49, 0x3B, 0xC7, 0x73, 0x3F, 0x41, 0x0F, 0xB6, 0x0A, 0x49, 0xFF, 0xC0, 0x88, 0x08, 0x49, 0xFF, 0xC2, 0x48, 0xFF, 0xC0, 0x49, 0x83, 0xF8, 0x20, 0x75, 0x0A, 0xC6, 0x40, 0xDF, 0x1F, 0x4C, 0x8B, 0xC6, 0x48, 0xFF, 0xC0, 0x49, 0x8D, 0x52, 0x02, 0x48, 0x3B, 0xD5, 0x0F, 0x82, 0x71, 0xFE, 0xFF, 0xFF, 0xEB, 0x03, 0x49, 0xFF, 0xC2, 0x4C, 0x8B, 0x4C, 0x24, 0x40, 0x48, 0x8D, 0x48, 0x03, 0x49, 0x3B, 0xCF, 0x76, 0x24, 0xB0, 0x01, 0x48, 0x8B, 0x7C, 0x24, 0x48, 0x48, 0x8B, 0x5C, 0x24, 0x30, 0x48, 0x8B, 0x74, 0x24, 0x38, 0x4C, 0x8B, 0x64, 0x24, 0x08, 0x4C, 0x8B, 0x3C, 0x24, 0x48, 0x83, 0xC4, 0x10, 0x41, 0x5E, 0x41, 0x5D, 0x5D, 0xC3, 0x4C, 0x3B, 0xD5, 0x73, 0x29, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x41, 0x0F, 0xB6, 0x0A, 0x49, 0xFF, 0xC0, 0x88, 0x08, 0x49, 0xFF, 0xC2, 0x48, 0xFF, 0xC0, 0x49, 0x83, 0xF8, 0x20, 0x75, 0x0A, 0xC6, 0x40, 0xDF, 0x1F, 0x4C, 0x8B, 0xC6, 0x48, 0xFF, 0xC0, 0x4C, 0x3B, 0xD5, 0x72, 0xDC, 0x48, 0x8B, 0xC8, 0x41, 0x8D, 0x50, 0xFF, 0x49, 0x2B, 0xC8, 0x4D, 0x85, 0xC0, 0x40, 0x0F, 0x94, 0xC6, 0x48, 0x2B, 0xC6, 0x88, 0x51, 0xFF, 0x49, 0x2B, 0xC1, 0x49, 0x89, 0x45, 0x00, 0x32, 0xC0, 0xEB, 0x8E, 0xB0, 0x03, 0x48, 0x83, 0xC4, 0x10, 0x41, 0x5E, 0x41, 0x5D, 0x5D, 0xC3 };
static uint8_t DECOMPRS[] = { 0x48, 0x89, 0x74, 0x24, 0x18, 0x41, 0x56, 0x4C, 0x8D, 0x1C, 0x11, 0x4D, 0x8B, 0xF1, 0x49, 0x8B, 0xF0, 0x4D, 0x8B, 0xD0, 0x4D, 0x85, 0xC9, 0x0F, 0x84, 0xBF, 0x01, 0x00, 0x00, 0x49, 0x8B, 0x01, 0x48, 0x89, 0x5C, 0x24, 0x10, 0x48, 0x89, 0x7C, 0x24, 0x18, 0x33, 0xFF, 0x49, 0x8D, 0x1C, 0x00, 0x48, 0x85, 0xC9, 0x75, 0x1C, 0x48, 0x85, 0xD2, 0x75, 0x1C, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0x32, 0xC0, 0x49, 0x89, 0x39, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3, 0x48, 0x85, 0xF6, 0x75, 0x1A, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0xB0, 0x03, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3, 0x66, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x0F, 0xB6, 0x11, 0x4C, 0x8B, 0xC1, 0x48, 0xFF, 0xC1, 0x48, 0x83, 0xFA, 0x20, 0x73, 0x35, 0x48, 0xFF, 0xC2, 0x4A, 0x8D, 0x04, 0x12, 0x48, 0x3B, 0xC3, 0x0F, 0x87, 0xA5, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x04, 0x0A, 0x49, 0x3B, 0xC3, 0x0F, 0x87, 0x9D, 0x00, 0x00, 0x00, 0x0F, 0x1F, 0x40, 0x00, 0x0F, 0xB6, 0x01, 0x48, 0xFF, 0xC1, 0x41, 0x88, 0x02, 0x49, 0xFF, 0xC2, 0x48, 0x83, 0xEA, 0x01, 0x75, 0xEE, 0xEB, 0x5D, 0x4C, 0x8B, 0xC2, 0x4D, 0x8B, 0xCA, 0x83, 0xE2, 0x1F, 0x49, 0xC1, 0xE8, 0x05, 0x48, 0xC1, 0xE2, 0x08, 0x4C, 0x2B, 0xCA, 0x49, 0xFF, 0xC9, 0x49, 0x83, 0xF8, 0x07, 0x75, 0x0B, 0x44, 0x0F, 0xB6, 0x01, 0x49, 0x83, 0xC0, 0x07, 0x48, 0xFF, 0xC1, 0x49, 0x83, 0xC0, 0x02, 0x4B, 0x8D, 0x04, 0x10, 0x48, 0x3B, 0xC3, 0x77, 0x64, 0x49, 0x3B, 0xCB, 0x73, 0x4B, 0x0F, 0xB6, 0x01, 0x48, 0xFF, 0xC1, 0x4C, 0x2B, 0xC8, 0x4C, 0x3B, 0xCE, 0x72, 0x3D, 0x4D, 0x2B, 0xCA, 0x90, 0x43, 0x0F, 0xB6, 0x04, 0x11, 0x41, 0x88, 0x02, 0x49, 0xFF, 0xC2, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xEF, 0x49, 0x3B, 0xCB, 0x0F, 0x82, 0x56, 0xFF, 0xFF, 0xFF, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0x4C, 0x2B, 0xD6, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x32, 0xC0, 0x4D, 0x89, 0x16, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3, 0x49, 0x8B, 0xC8, 0xEB, 0x22, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0xB0, 0x02, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3, 0x49, 0x83, 0xF8, 0x09, 0x48, 0x1B, 0xC0, 0x48, 0x83, 0xC0, 0x02, 0x48, 0x2B, 0xC8, 0x8B, 0xD7, 0x49, 0x3B, 0xCB, 0x73, 0x5A, 0x0F, 0xB6, 0x01, 0x48, 0xFF, 0xC1, 0x48, 0x83, 0xF8, 0x20, 0x73, 0x28, 0x48, 0xFF, 0xC0, 0x48, 0x03, 0xC8, 0x49, 0x3B, 0xCB, 0x76, 0x3C, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0x48, 0x2B, 0xFE, 0x49, 0x03, 0xFA, 0xB0, 0x02, 0x49, 0x89, 0x3E, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3, 0x48, 0xC1, 0xE8, 0x05, 0x48, 0x83, 0xF8, 0x07, 0x75, 0x0A, 0x0F, 0xB6, 0x01, 0x48, 0x83, 0xC0, 0x07, 0x48, 0xFF, 0xC1, 0x49, 0x3B, 0xCB, 0x73, 0xCA, 0x48, 0xFF, 0xC1, 0x83, 0xC2, 0x02, 0x03, 0xD0, 0x49, 0x3B, 0xCB, 0x72, 0xA6, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0x32, 0xC0, 0x48, 0x63, 0xFA, 0x48, 0x2B, 0xFE, 0x49, 0x03, 0xFA, 0x49, 0x89, 0x3E, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3, 0xB0, 0x03, 0x48, 0x8B, 0x74, 0x24, 0x20, 0x41, 0x5E, 0xC3 };
static uint8_t sm_crc_32[] = { 0x4C, 0x8B, 0xDA, 0xF7, 0xD1, 0x4D, 0x85, 0xC0, 0x74, 0x28, 0x66, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x45, 0x0F, 0xB6, 0x13, 0x4D, 0x8D, 0x5B, 0x01, 0x8B, 0xC1, 0x8B, 0xD1, 0x4C, 0x33, 0xD0, 0xC1, 0xEA, 0x08, 0x41, 0x0F, 0xB6, 0xC2, 0x41, 0x8B, 0x0C, 0x81, 0x33, 0xCA, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xDE, 0xF7, 0xD1, 0x8B, 0xC1, 0xC3 };
static uint8_t sm_crc_64[] = { 0x4D, 0x85, 0xC0, 0x74, 0x2D, 0x66, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x44, 0x0F, 0xB6, 0x12, 0x48, 0x8D, 0x52, 0x01, 0x0F, 0xB6, 0xC1, 0x4C, 0x33, 0xD0, 0x48, 0x8B, 0xC1, 0x48, 0xC1, 0xE8, 0x08, 0x4B, 0x8B, 0x0C, 0xD1, 0x48, 0x33, 0xC8, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xDE, 0x48, 0x8B, 0xC1, 0xC3 };
static uint8_t MEMCPYFN[] = { 0x40, 0x53, 0x48, 0x83, 0xEC, 0x20, 0x48, 0x8B, 0xD9, 0x48, 0x3B, 0xCA, 0x73, 0x13, 0x4D, 0x85, 0xC0, 0x74, 0x40, 0xE8, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8B, 0xC3, 0x48, 0x83, 0xC4, 0x20, 0x5B, 0xC3, 0x48, 0x8D, 0x4A, 0xFF, 0x49, 0x8D, 0x50, 0xFF, 0x49, 0x03, 0xC8, 0x48, 0x03, 0xD3, 0x4D, 0x85, 0xC0, 0x74, 0x1F, 0x0F, 0x1F, 0x40, 0x00, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0xB6, 0x01, 0x48, 0x8D, 0x49, 0xFF, 0x88, 0x02, 0x48, 0x8D, 0x52, 0xFF, 0x49, 0x83, 0xE8, 0x01, 0x75, 0xED, 0x48, 0x8B, 0xC3, 0x48, 0x83, 0xC4, 0x20, 0x5B, 0xC3 };
static uint8_t MEMMEMFN[] = { 0x48, 0x89, 0x5C, 0x24, 0x18, 0x56, 0x4C, 0x8B, 0xD9, 0x49, 0x8B, 0xD9, 0x4D, 0x2B, 0xD9, 0x49, 0x8B, 0xF0, 0x4C, 0x03, 0xDA, 0x4C, 0x8B, 0xD1, 0x4D, 0x85, 0xC9, 0x75, 0x0A, 0x48, 0x8B, 0xC1, 0x48, 0x8B, 0x5C, 0x24, 0x20, 0x5E, 0xC3, 0x48, 0x3B, 0xD3, 0x73, 0x09, 0x33, 0xC0, 0x48, 0x8B, 0x5C, 0x24, 0x20, 0x5E, 0xC3, 0x48, 0x89, 0x6C, 0x24, 0x10, 0x48, 0x89, 0x7C, 0x24, 0x18, 0x49, 0x3B, 0xCB, 0x77, 0x69, 0x41, 0x0F, 0xB6, 0x38, 0x33, 0xED, 0x66, 0x0F, 0x1F, 0x44, 0x00, 0x00, 0x41, 0x38, 0x3A, 0x75, 0x50, 0x48, 0x8D, 0x43, 0xFF, 0x4C, 0x8D, 0x4E, 0x01, 0x4D, 0x8D, 0x42, 0x01, 0x48, 0x85, 0xC0, 0x74, 0x26, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x0F, 0xB6, 0x10, 0x48, 0xFF, 0xC8, 0x41, 0x0F, 0xB6, 0x09, 0x4D, 0x8D, 0x49, 0x01, 0x4D, 0x8D, 0x40, 0x01, 0x3A, 0xD1, 0x75, 0x19, 0x48, 0x85, 0xC0, 0x75, 0xE4, 0x48, 0x8B, 0x6C, 0x24, 0x10, 0x49, 0x8B, 0xC2, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x5C, 0x24, 0x20, 0x5E, 0xC3, 0x40, 0x84, 0xED, 0x75, 0xE7, 0x49, 0xFF, 0xC2, 0x4D, 0x3B, 0xD3, 0x76, 0xA3, 0x48, 0x8B, 0x6C, 0x24, 0x10, 0x33, 0xC0, 0x48, 0x8B, 0x7C, 0x24, 0x18, 0x48, 0x8B, 0x5C, 0x24, 0x20, 0x5E, 0xC3 };
static uint8_t sm_mem_xor_func[] = { 0x48, 0x89, 0x5C, 0x24, 0x08, 0x48, 0x89, 0x6C, 0x24, 0x10, 0x48, 0x89, 0x74, 0x24, 0x18, 0x48, 0x89, 0x7C, 0x24, 0x20, 0x41, 0x56, 0x48, 0x83, 0xEC, 0x20, 0x49, 0x8B, 0xE9, 0x4D, 0x8B, 0xF0, 0x48, 0x8B, 0xFA, 0x48, 0x8B, 0xF1, 0x48, 0x8B, 0xD9, 0x48, 0x85, 0xD2, 0x74, 0x14, 0x66, 0x90, 0x48, 0x8B, 0xCD, 0x41, 0xFF, 0xD6, 0x30, 0x03, 0x48, 0x8D, 0x5B, 0x01, 0x48, 0x83, 0xEF, 0x01, 0x75, 0xEE, 0x48, 0x8B, 0x5C, 0x24, 0x30, 0x48, 0x8B, 0xC6, 0x48, 0x8B, 0x74, 0x24, 0x40, 0x48, 0x8B, 0x6C, 0x24, 0x38, 0x48, 0x8B, 0x7C, 0x24, 0x48, 0x48, 0x83, 0xC4, 0x20, 0x41, 0x5E, 0xC3 };
static uint8_t sm_city_64_hash[] = { 0x48, 0x89, 0x5C, 0x24, 0x10, 0x48, 0x89, 0x6C, 0x24, 0x18, 0x48, 0x89, 0x7C, 0x24, 0x20, 0x48, 0x89, 0x4C, 0x24, 0x08, 0x41, 0x54, 0x41, 0x55, 0x41, 0x56, 0x41, 0x57, 0x48, 0x8B, 0x44, 0x24, 0x40, 0x48, 0xBF, 0x4F, 0x40, 0x90, 0x2F, 0x3B, 0x6A, 0xE1, 0x9A, 0x41, 0xB8, 0x08, 0x00, 0x00, 0x00, 0x49, 0xBD, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x49, 0x3B, 0xD0, 0x41, 0xBC, 0x00, 0x00, 0x00, 0xFF, 0x4C, 0x0F, 0x46, 0xC2, 0x48, 0x8D, 0x14, 0xC0, 0x48, 0x0F, 0xAF, 0xCF, 0x4E, 0x8B, 0x5C, 0x04, 0x20, 0x4E, 0x8D, 0x3C, 0x47, 0x4A, 0x8B, 0x5C, 0x04, 0x10, 0x4C, 0x8D, 0x52, 0x01, 0x4E, 0x8B, 0x74, 0x04, 0x08, 0x4A, 0x8B, 0x6C, 0x04, 0x18, 0x4C, 0x8B, 0x44, 0x24, 0x38, 0x4E, 0x8D, 0x0C, 0x19, 0x48, 0x8B, 0x4C, 0x24, 0x30, 0x49, 0x8B, 0xC1, 0x49, 0x33, 0xC6, 0x48, 0xC1, 0xC9, 0x1E, 0x4C, 0x03, 0xD0, 0x49, 0xC1, 0xC1, 0x15, 0x48, 0x03, 0xCB, 0x4C, 0x0F, 0xAF, 0xC7, 0x49, 0x0F, 0xAF, 0xEF, 0x4C, 0x03, 0xC2, 0x49, 0x8D, 0x04, 0x0A, 0x48, 0x8D, 0x04, 0xC8, 0x49, 0x8B, 0xF8, 0x4C, 0x03, 0xC8, 0x48, 0xC1, 0xC7, 0x16, 0x4D, 0x0F, 0xAF, 0xCF, 0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x48, 0xB9, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x49, 0x8B, 0xD1, 0x48, 0x03, 0xFB, 0x48, 0x23, 0xD0, 0x49, 0x8B, 0xC1, 0x48, 0xC1, 0xE8, 0x10, 0x48, 0x0B, 0xD0, 0x49, 0x8B, 0xC1, 0x48, 0x23, 0xC1, 0x48, 0xC1, 0xEA, 0x10, 0x48, 0x0B, 0xD0, 0x49, 0x8B, 0xC9, 0x48, 0xC1, 0xEA, 0x10, 0x81, 0xE1, 0x00, 0xFF, 0x00, 0x00, 0x49, 0x8B, 0xC1, 0x49, 0x23, 0xC5, 0x48, 0x0B, 0xD0, 0x49, 0x8B, 0xC1, 0x48, 0xC1, 0xE0, 0x10, 0x48, 0x0B, 0xC8, 0x48, 0xC1, 0xEA, 0x08, 0x49, 0x8B, 0xC1, 0x48, 0xC1, 0xE1, 0x10, 0x25, 0x00, 0x00, 0xFF, 0x00, 0x4D, 0x23, 0xCC, 0x48, 0x0B, 0xC8, 0x48, 0xC1, 0xE1, 0x10, 0x49, 0x0B, 0xC9, 0x4D, 0x8D, 0x0C, 0x18, 0x48, 0xC1, 0xE1, 0x08, 0x48, 0x0B, 0xD1, 0x49, 0x03, 0xD2, 0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x48, 0x03, 0xD5, 0x49, 0x0F, 0xAF, 0xD7, 0x49, 0x03, 0xD3, 0x49, 0xBB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x4C, 0x8B, 0xC2, 0x48, 0x8B, 0xC2, 0x4D, 0x23, 0xC3, 0x48, 0xC1, 0xE8, 0x10, 0x4C, 0x0B, 0xC0, 0x48, 0x8B, 0xC2, 0x49, 0x23, 0xC2, 0x49, 0xC1, 0xE8, 0x10, 0x4C, 0x0B, 0xC0, 0x49, 0xC1, 0xE8, 0x10, 0x48, 0x8B, 0x5C, 0x24, 0x30, 0x48, 0x8B, 0xCA, 0x48, 0x8B, 0xC2, 0x81, 0xE1, 0x00, 0xFF, 0x00, 0x00, 0x49, 0x23, 0xC5, 0x4C, 0x0B, 0xC0, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE0, 0x10, 0x48, 0x0B, 0xC8, 0x49, 0xC1, 0xE8, 0x08, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE1, 0x10, 0x25, 0x00, 0x00, 0xFF, 0x00, 0x49, 0x23, 0xD4, 0x48, 0x0B, 0xC8, 0x48, 0xC1, 0xE1, 0x10, 0x48, 0x0B, 0xCA, 0x48, 0xC1, 0xE1, 0x08, 0x4C, 0x0B, 0xC1, 0x4D, 0x03, 0xC1, 0x4C, 0x03, 0xC7, 0x4D, 0x0F, 0xAF, 0xC7, 0x49, 0x8B, 0xC8, 0x49, 0x8B, 0xD0, 0x49, 0x23, 0xD3, 0x81, 0xE1, 0x00, 0xFF, 0x00, 0x00, 0x49, 0x8B, 0xC0, 0x48, 0xC1, 0xE8, 0x10, 0x48, 0x0B, 0xD0, 0x49, 0x8B, 0xC0, 0x49, 0x23, 0xC2, 0x48, 0xC1, 0xEA, 0x10, 0x48, 0x0B, 0xD0, 0x49, 0x8B, 0xC0, 0x49, 0x23, 0xC5, 0x48, 0xC1, 0xEA, 0x10, 0x48, 0x0B, 0xD0, 0x49, 0x8B, 0xC0, 0x48, 0xC1, 0xE0, 0x10, 0x48, 0x0B, 0xC8, 0x48, 0xC1, 0xEA, 0x08, 0x48, 0xC1, 0xE1, 0x10, 0x49, 0x8B, 0xC0, 0x25, 0x00, 0x00, 0xFF, 0x00, 0x4D, 0x23, 0xC4, 0x48, 0x0B, 0xC8, 0x48, 0xC1, 0xE1, 0x10, 0x49, 0x0B, 0xC8, 0x48, 0xC1, 0xE1, 0x08, 0x48, 0x0B, 0xD1, 0x48, 0x03, 0x54, 0x24, 0x30, 0x49, 0x03, 0xD1, 0x49, 0x0F, 0xAF, 0xD7, 0x48, 0x03, 0xD5, 0x48, 0x8B, 0x6C, 0x24, 0x38, 0x49, 0x03, 0xD6, 0x48, 0x8B, 0xC2, 0x48, 0xC1, 0xE8, 0x2F, 0x48, 0x33, 0xC2, 0x49, 0x0F, 0xAF, 0xC7, 0x48, 0x03, 0xC7, 0x48, 0x8B, 0x7C, 0x24, 0x40, 0x41, 0x5F, 0x41, 0x5E, 0x41, 0x5D, 0x41, 0x5C, 0xC3 };
static uint8_t sm_murmur_3_32_hash[] = { 0x4C, 0x8B, 0xCA, 0x41, 0xBA, 0xD3, 0xDD, 0x36, 0x1F, 0x49, 0xC1, 0xE9, 0x02, 0x46, 0x8D, 0x1C, 0x8D, 0x00, 0x00, 0x00, 0x00, 0x4C, 0x03, 0xD9, 0x41, 0xF7, 0xD9, 0x74, 0x2C, 0x0F, 0x1F, 0x00, 0x43, 0x69, 0x0C, 0x8B, 0x51, 0x2D, 0x9E, 0xCC, 0xC1, 0xC1, 0x0F, 0x69, 0xC1, 0x93, 0x35, 0x87, 0x1B, 0x44, 0x33, 0xD0, 0x41, 0xC1, 0xC2, 0x0D, 0x41, 0x81, 0xC2, 0x14, 0xAF, 0xDD, 0xFA, 0x47, 0x8D, 0x14, 0x92, 0x41, 0x83, 0xC1, 0x01, 0x75, 0xD7, 0x48, 0x8B, 0xC2, 0x33, 0xC9, 0x83, 0xE0, 0x03, 0x48, 0x83, 0xE8, 0x01, 0x74, 0x1E, 0x48, 0x83, 0xE8, 0x01, 0x74, 0x0E, 0x48, 0x83, 0xF8, 0x01, 0x75, 0x2A, 0x41, 0x0F, 0xB6, 0x4B, 0x02, 0xC1, 0xE1, 0x10, 0x41, 0x0F, 0xB6, 0x43, 0x01, 0xC1, 0xE0, 0x08, 0x33, 0xC8, 0x41, 0x0F, 0xB6, 0x03, 0x33, 0xC1, 0x69, 0xC8, 0x51, 0x2D, 0x9E, 0xCC, 0xC1, 0xC1, 0x0F, 0x69, 0xC1, 0x93, 0x35, 0x87, 0x1B, 0x44, 0x33, 0xD0, 0x44, 0x33, 0xD2, 0x41, 0x8B, 0xC2, 0xC1, 0xE8, 0x10, 0x41, 0x33, 0xC2, 0x69, 0xC8, 0x6B, 0xCA, 0xEB, 0x85, 0x8B, 0xC1, 0xC1, 0xE8, 0x0D, 0x33, 0xC1, 0x69, 0xC8, 0x35, 0xAE, 0xB2, 0xC2, 0x8B, 0xC1, 0xC1, 0xE8, 0x10, 0x33, 0xC1, 0xC3 };
static uint8_t sm_murmur_3_64_hash[] = { 0x48, 0x89, 0x74, 0x24, 0x10, 0x57, 0x4C, 0x8B, 0xC2, 0x48, 0xBF, 0xD5, 0x53, 0x42, 0x11, 0x91, 0x7B, 0xC3, 0x87, 0x49, 0xC1, 0xE8, 0x04, 0x48, 0xBE, 0x7F, 0x93, 0x45, 0x27, 0x43, 0xAD, 0xF5, 0x4C, 0x49, 0xB9, 0x79, 0x71, 0x09, 0x1D, 0x7D, 0x7F, 0x5C, 0x00, 0x49, 0xBA, 0x20, 0x2C, 0x83, 0x37, 0x5A, 0x24, 0x00, 0x00, 0x4D, 0x85, 0xC0, 0x74, 0x6D, 0x48, 0x89, 0x5C, 0x24, 0x10, 0x4C, 0x8B, 0xD9, 0x49, 0x8B, 0xD8, 0x66, 0x66, 0x66, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x49, 0x8B, 0x03, 0x4D, 0x8D, 0x5B, 0x10, 0x48, 0x0F, 0xAF, 0xC7, 0x48, 0xC1, 0xC0, 0x1F, 0x48, 0x0F, 0xAF, 0xC6, 0x49, 0x33, 0xC1, 0x48, 0xC1, 0xC0, 0x1B, 0x49, 0x03, 0xC2, 0x4C, 0x8D, 0x0C, 0x85, 0x29, 0xE7, 0xDC, 0x52, 0x4C, 0x03, 0xC8, 0x49, 0x8B, 0x43, 0xF8, 0x48, 0x0F, 0xAF, 0xC6, 0x48, 0xC1, 0xC8, 0x1F, 0x48, 0x0F, 0xAF, 0xC7, 0x49, 0x33, 0xC2, 0x48, 0xC1, 0xC0, 0x1F, 0x48, 0x05, 0xF1, 0xDE, 0x41, 0x0B, 0x49, 0x03, 0xC1, 0x4C, 0x8D, 0x14, 0x80, 0x48, 0x83, 0xEB, 0x01, 0x75, 0xAE, 0x48, 0x8B, 0x5C, 0x24, 0x10, 0x49, 0xC1, 0xE0, 0x04, 0x33, 0xC0, 0x4C, 0x03, 0xC1, 0x48, 0x8B, 0xCA, 0x83, 0xE1, 0x0F, 0x48, 0xFF, 0xC9, 0x48, 0x83, 0xF9, 0x0E, 0x0F, 0x87, 0xD7, 0x00, 0x00, 0x00, 0x4C, 0x8D, 0x1D, 0x00, 0x00, 0x00, 0x00, 0x41, 0x8B, 0x8C, 0x8B, 0x00, 0x00, 0x00, 0x00, 0x49, 0x03, 0xCB, 0xFF, 0xE1, 0x41, 0x0F, 0xB6, 0x40, 0x0E, 0x48, 0xC1, 0xE0, 0x30, 0x41, 0x0F, 0xB6, 0x48, 0x0D, 0x48, 0xC1, 0xE1, 0x28, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x0C, 0x48, 0xC1, 0xE1, 0x20, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x0B, 0x48, 0xC1, 0xE1, 0x18, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x0A, 0x48, 0xC1, 0xE1, 0x10, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x09, 0x48, 0xC1, 0xE1, 0x08, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x08, 0x48, 0x33, 0xC8, 0x48, 0x0F, 0xAF, 0xCE, 0x48, 0xC1, 0xC9, 0x1F, 0x48, 0x0F, 0xAF, 0xCF, 0x4C, 0x33, 0xD1, 0x41, 0x0F, 0xB6, 0x40, 0x07, 0x48, 0xC1, 0xE0, 0x38, 0x41, 0x0F, 0xB6, 0x48, 0x06, 0x48, 0xC1, 0xE1, 0x30, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x05, 0x48, 0xC1, 0xE1, 0x28, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x04, 0x48, 0xC1, 0xE1, 0x20, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x03, 0x48, 0xC1, 0xE1, 0x18, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x02, 0x48, 0xC1, 0xE1, 0x10, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x48, 0x01, 0x48, 0xC1, 0xE1, 0x08, 0x48, 0x33, 0xC1, 0x41, 0x0F, 0xB6, 0x08, 0x48, 0x33, 0xC8, 0x48, 0x0F, 0xAF, 0xCF, 0x48, 0xC1, 0xC1, 0x1F, 0x48, 0x0F, 0xAF, 0xCE, 0x4C, 0x33, 0xC9, 0x48, 0x8B, 0x74, 0x24, 0x18, 0x4C, 0x33, 0xD2, 0x4C, 0x33, 0xCA, 0x4D, 0x03, 0xCA, 0x4D, 0x03, 0xD1, 0x4D, 0x03, 0xCA, 0x4B, 0x8D, 0x04, 0x0A, 0x49, 0x33, 0xC1, 0x5F, 0xC3, 0x90, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };


#define rseed sm_rand_48_32_seed
#define rnext sm_rand_48_32_rand


extern void rseed(void* state, uint64_t seed);
extern uint64_t rnext(void* state);


// In-place XOR ptr using sequence generated by rnext, with state seeded by seed.
static void* mxorpass(void *restrict ptr, register size_t len, uint64_t seed)
{
	uint16_t s[3] = { 0U, 0U, 0U };
	rseed(s, seed);
	register uint8_t* d = (uint8_t*)ptr;
	while (len-- > 0U) *d++ ^= rnext(s);
	s[0] = s[1] = s[2] = 0U;
	return ptr;
}


// Makes random seed.
inline static uint64_t make_seed(void)
{
	extern uint64_t callconv sm_master_rand();
	return sm_master_rand();
}


// Delete the specified file before opening it.
FILE* open_file(const char* path)
{
	FILE* r = fopen(path, "r");
	if (r) fclose(r);
	if (r) remove(path);
	return fopen(path, "w");
}


// Trim leading and following whitespace.
char* trim(char* s)
{
	while (isspace((unsigned char)*s)) s++;
	if (*s == 0) return s;
	char* e = s + strlen(s) - 1;
	while (e > s && isspace((int)*e)) e--;
	*(e + 1) = 0;
	return s;
}


// Replace m in s with r.
int replace(char* s, const char* m, const char* r)
{
	int rc = 0;
	char b[0x4000] = { 0 };
	char* i = &b[0];
	const char *p, *t = s;
	size_t ml = strlen(m), rl = strlen(r);
	while (1) 
	{
		p = strstr(t, m);
		if (p == NULL) 
		{
			strcpy(i, t);
			break;
		}
		memcpy(i, t, p - t);
		i += p - t;
		memcpy(i, r, rl);
		i += rl;
		t = p + ml;
		rc++;
	}
	strcpy(s, b);
	return rc;
}


int evaluate_size(char* entity_size, uint64_t* result);


/*
Input Format: 

For a data entry:

# Optional emitted comment.\n
DA: NAME = BYTE0 .. BYTEN;\n

For a function entry:

# Optional emitted comment.\n
FN: NAME = BYTE0 .. BYTEN;\n

For a size entry:

# Optional emitted comment.\n
SZ: NAME = EXPR;\n

*/


// Makes an 8-character hex alias name, where the initial char is an hex letter digit.
char* make_alias(char* buffer, void* rnd_state)
{
	const char prefixes[6] = { 'a', 'b', 'c', 'd', 'e', 'f' };
	uint16_t code = (uint16_t)(rnext(rnd_state) ^ rnext(rnd_state));
	sprintf(buffer, "%c%07x", prefixes[(rnext(rnd_state) + 1) % sizeof(prefixes)], code);
	buffer[8] = '\0';
	return buffer;
}


int main(int argc, char* argv[])
{
	printf("MKC Code Generator for Secure Memory Library\n");
	printf("Copyright (C) 2017 by the Secure Memory Project, All rights Reserved\n");

	if (argc < 3)
	{
		printf("USAGE: mkc <stem> <in0> [.. inN]");
		return -1;
	}

	char* target_stem = argv[1];

	char target_op_decl_name[512], target_op_data_name[512], target_op_impl_name[512];
	FILE *target_op_decl_file, *target_op_data_file, *target_op_impl_file, *input;

	sprintf(target_op_decl_name, "%s_op_decl.h", target_stem);
	sprintf(target_op_data_name, "%s_op_data.h", target_stem);
	sprintf(target_op_impl_name, "%s_op_impl.h", target_stem);

	target_op_decl_file = open_file(target_op_decl_name);
	target_op_data_file = open_file(target_op_data_name);
	target_op_impl_file = open_file(target_op_impl_name);

	if (!target_op_decl_file) { printf("mkc: Error: Failed to open decl file \"%s\" for output.\n", target_op_decl_name); return -1; }
	if (!target_op_data_file) { printf("mkc: Error: Failed to open data file \"%s\" for output.\n", target_op_data_name); return -1; }
	if (!target_op_impl_file) { printf("mkc: Error: Failed to open impl file \"%s\" for output.\n", target_op_impl_name); return -1; }

	uint64_t entity_xor_key = 0, entity_alias_id = 0;
	uint16_t entity_op_code = 0xFFFF;

	char entity_alias_name[128];

	uint16_t random_state[3] = { 0, 0, 0 };
	rseed(random_state, (uint32_t)make_seed());

	uint32_t i, j;

	for (i = 2; i < (uint32_t)argc; ++i)
	{
		input = fopen(argv[i], "r");

		if (input == NULL)
		{
			printf("mkc: Warning: Failed to open source file \"%s\" for input. Skipping.\n", argv[i]);
			continue;
		}

		char line_buffer[0x4000] = { 0 }, *line;
		char comment[1024] = { 0 };

		int kind = 0;

		while (fgets(line_buffer, 0x4000, input))
		{
			line = trim(line_buffer);

			if (strlen(line) == 0) continue;

			if (line[0] == '#')
			{
				line = trim(line + 1);
				if (strlen(line) == 0) comment[0] = '\0';
				else sprintf(comment, "%s", trim(line));
			}
			else if (strlen(line) > 12 && line[0] == 'D' || line[0] == 'F' || line[0] == 'S')
			{
				kind = (line[0] == 'D') ? 1 : (line[0] == 'F') ? 2 : 3; // Data, Function, Size.

				char* working = trim(line + 2);
				char* tok = strtok(working, " :,=;");

				char entity_name[128];
				char entity_size[1024];
				strcpy(entity_name, tok);

				uint32_t code_len = 0;
				uint8_t entity_bytes[0x4000];

				if (kind < 3)
				{
					while ((tok = strtok(NULL, " \t:,=;")) != NULL)
					{
						char* eptr = NULL;
						entity_bytes[code_len] = (uint8_t)strtoul(tok, &eptr, 16);
						++code_len;
					}

					if (code_len == 0)
					{
						comment[0] = '\0';
						line_buffer[0] = '\0';
						entity_size[0] = '\0';
						continue;
					}
				}
				else
				{
					tok = strtok(NULL, "=;");

					if (tok == NULL)
					{
						comment[0] = '\0';
						line_buffer[0] = '\0';
						entity_size[0] = '\0';
						continue;
					}

					tok = trim(tok);

					if (strlen(tok) == 0)
					{
						comment[0] = '\0';
						line_buffer[0] = '\0';
						entity_size[0] = '\0';
						continue;
					}

					strcpy(entity_size, tok);
				}

				entity_xor_key = (((uint64_t)rnext(random_state) << 32) ^ (uint64_t)rnext(random_state));
				entity_alias_id = (((uint64_t)rnext(random_state) << 32) ^ (uint64_t)rnext(random_state));

				make_alias(entity_alias_name, random_state);

				printf("mkc: Generating code for \"%s\" (%s type)...\n", entity_name, kind == 1 ? "data" : kind == 2 ? "function" : "size");

				if (kind < 3)
				{
					mxorpass(entity_bytes, code_len, entity_xor_key);

					if (strlen(comment)) fprintf(target_op_data_file, "// %s: %s\n", kind == 1 ? "Data" : "Function", comment);
					else fprintf(target_op_data_file, "// %s.\n", kind == 1 ? "Data" :"Function");

					fprintf(target_op_data_file, "#define %s %s\n", entity_name, entity_alias_name);

					make_alias(entity_alias_name, random_state);

					fprintf(target_op_data_file, "#define %s_key %s\n", entity_name, entity_alias_name);
					fprintf(target_op_data_file, "static uint64_t %s_key = UINT64_C(0x%" PRIX64 ");\n", entity_name, entity_xor_key);
					fprintf(target_op_data_file, "static uint8_t %s[] = { ", entity_name);

					for (j = 0; j < code_len; ++j)
					{
						fprintf(target_op_data_file, "0x%02X", entity_bytes[j]);
						if (i < code_len - 1) fprintf(target_op_data_file, ", ");
					}

					fprintf(target_op_data_file, " };\n\n");
				}
				else
				{
					uint64_t entity_size_value = 0ULL;
					if (evaluate_size(entity_size, &entity_size_value) >= 0)
						sprintf(entity_size, "0x%" PRIX64 "", entity_size_value);
					else
					{
						printf("Error: Failed to evaluate size expression \"%s\" (condensed).\n", entity_size);
						return -1;
					}
					if (entity_size_value == 0)
						printf("Warning: Entity size \"%s\" (condensed) evaluates to zero.\n", entity_size);
				}

				if (strlen(comment))
					fprintf(target_op_decl_file, "#define sec_op_%s (0x%04XU) // %s: %s\n", entity_name, entity_op_code, kind == 1 ? "Data" : kind == 2 ? "Function" : "Size", comment);
				else fprintf(target_op_decl_file, "#define sec_op_%s (0x%04XU) // %s.\n", entity_name, entity_op_code, kind == 1 ? "Data" : kind == 2 ? "Function" : "Size");

				if (kind < 3)
					fprintf(target_op_impl_file, "case sec_op_%s: return (uint64_t)sec_op_load_%s(%s);\n", entity_name, kind == 1 ? "data" : "function", entity_name);
				else fprintf(target_op_impl_file, "case sec_op_%s: return %s;\n", entity_name, entity_size);

				comment[0] = '\0';
				line_buffer[0] = '\0';
				entity_size[0] = '\0';
			}

			line_buffer[0] = '\0';
		}

		fclose(input);

		input = NULL;
	}

	fflush(target_op_decl_file);
	fclose(target_op_decl_file);

	fflush(target_op_data_file);
	fclose(target_op_data_file);

	fflush(target_op_impl_file);
	fclose(target_op_impl_file);

	printf("mkc: Generated: %s_op_decl.h, %s_op_data.h, and %s_op_impl.h.\n", target_stem, target_stem, target_stem);
	printf("mkc: Done.\n");

	return 0;
}


char* to_size_string(char* buf, uint64_t size)
{
	sprintf(buf, "%" PRIu64, size);
	return buf;
}


int eval(char*, uint64_t*);


// Evaluate size expressions.
int evaluate_size(char* entity_size, uint64_t* result)
{
	uint32_t i = 0, n, b = 10, q = 0;
	char buf[256], *d;

	entity_size = trim(entity_size);

	// Eliminate multi-pointer expressions since they are likely of the same size.

	while (replace(entity_size, "**)", "*)"));

	// We're using single-char operator tokens.

	replace(entity_size, ">>", ">");
	replace(entity_size, "<<", "<");

#define REP(X) replace(entity_size, #X, to_size_string(buf, X))

	// Speculatively replace sizeof expressions with their values.

	// PODs & their pointers.

	REP(sizeof(char));                   REP(sizeof(char*));
	REP(sizeof(unsigned char));          REP(sizeof(unsigned char*));
	REP(sizeof(short));                  REP(sizeof(short*));
	REP(sizeof(short int));              REP(sizeof(short int*));
	REP(sizeof(unsigned short));         REP(sizeof(unsigned short*));
	REP(sizeof(unsigned short int));     REP(sizeof(unsigned short int*));
	REP(sizeof(int));                    REP(sizeof(int*));
	REP(sizeof(unsigned int));           REP(sizeof(unsigned int*));
	REP(sizeof(long));                   REP(sizeof(long*));
	REP(sizeof(unsigned long));          REP(sizeof(unsigned long*));
	REP(sizeof(unsigned long int));      REP(sizeof(unsigned long int*));
	REP(sizeof(long long));              REP(sizeof(long long*));
	REP(sizeof(long long int));          REP(sizeof(long long int*));
	REP(sizeof(unsigned long long));     REP(sizeof(unsigned long long*));
	REP(sizeof(unsigned long long int)); REP(sizeof(unsigned long long int*));
	REP(sizeof(float));                  REP(sizeof(float*));
	REP(sizeof(double));                 REP(sizeof(double*));
	REP(sizeof(long double));            REP(sizeof(long double*));
	REP(sizeof(void*));

	// Well-know types & their pointers.

	REP(sizeof(int8_t));				REP(sizeof(int8_t*));
	REP(sizeof(int16_t));   			REP(sizeof(int16_t*));
	REP(sizeof(int32_t));   			REP(sizeof(int32_t*));
	REP(sizeof(int64_t));   			REP(sizeof(int64_t*));
	REP(sizeof(uint8_t));   			REP(sizeof(uint8_t*));
	REP(sizeof(uint16_t));  			REP(sizeof(uint16_t*));
	REP(sizeof(uint32_t));  			REP(sizeof(uint32_t*));
	REP(sizeof(uint64_t));  			REP(sizeof(uint64_t*));
	REP(sizeof(size_t));    			REP(sizeof(size_t*));
	REP(sizeof(ssize_t));   			REP(sizeof(ssize_t*));
	REP(sizeof(off_t));     			REP(sizeof(off_t*));
	REP(sizeof(ptrdiff_t)); 			REP(sizeof(ptrdiff_t*));
	REP(sizeof(clock_t)); 				REP(sizeof(clock_t*));
	REP(sizeof(time_t)); 				REP(sizeof(time_t*));
	REP(sizeof(wchar_t)); 				REP(sizeof(wchar_t*));
	REP(sizeof(errno_t));				REP(sizeof(errno_t*));
	REP(sizeof(uintptr_t));				REP(sizeof(uintptr_t*));
	REP(sizeof(uid_t));					REP(sizeof(uid_t*));
	REP(sizeof(pid_t));					REP(sizeof(pid_t*));
	REP(sizeof(locale_t));				REP(sizeof(locale_t*));
	REP(sizeof(struct timeval));		REP(sizeof(struct timeval*));
	REP(sizeof(struct tm));				REP(sizeof(struct tm*));
	REP(sizeof(struct timeb));			REP(sizeof(struct timeb*));
	REP(sizeof(fd_set));				REP(sizeof(fd_set*));
	REP(sizeof(FILE*)); 				

#if defined(SEC_OS_WINDOWS)
	REP(sizeof(HANDLE));
	REP(sizeof(GUID));					REP(sizeof(GUID*));
#else
	REP(sizeof(guid_t));				REP(sizeof(guid_t*));
#endif

	// Constants from limits.h, stdint.h, and float.h.

	REP(CHAR_BIT);
	REP(SCHAR_MAX);						REP(UCHAR_MAX);
	REP(SHRT_MAX);						REP(USHRT_MAX);
	REP(INT_MAX);						REP(UINT_MAX);
	REP(LONG_MAX);						REP(ULONG_MAX);
	REP(LLONG_MAX);						REP(ULLONG_MAX);
	REP(INT8_MAX);						REP(UINT8_MAX);
	REP(INT16_MAX);						REP(UINT16_MAX);
	REP(INT32_MAX);						REP(UINT32_MAX);
	REP(INT64_MAX);						REP(UINT64_MAX);
	REP(FLT_MANT_DIG);					REP(FLT_MAX_EXP);
	REP(DBL_MANT_DIG);					REP(DBL_MAX_EXP);
	REP(LDBL_MANT_DIG);					REP(LDBL_MAX_EXP);

#undef REP

	// Test for expressions of a single numerical value with no parens or operators.

	n = (uint32_t)strlen(entity_size);

	if (n > 2 && entity_size[0] == '0' && entity_size[1] == 'x')
	{
		entity_size += 2;
		b = 16;
	}

	q = 1;

	for (i = 0; i < n; ++i) // Look for non-numeric characters.
		if (!isxdigit(entity_size[i])) { q = 0; break; }

	// Just one number, so we don't need to evaluate.

	if (q)
	{
		*result = strtoull(entity_size, &d, b);
		return 0;
	}

	*result = 0;

	return eval(entity_size, result);
}


// Dynamic evaluation support.
static char sym[] = "+-*/^<>|&%#)(", ops[256], tok[256];
static int opp, asp, par, sta = 0;
static uint64_t arg[256];static void opsh(char), apsh(uint64_t);
static int apop(uint64_t*), opop(int*), oeva(), peva();
static char *eget(char*), *oget(char*);


// Primitive unsigned 64-bit expression evaluator. Evaluates str and returns the computed value in *val. Returns 0 on success, else -1.
// Supports the following infix operators: +, -, *, /, < (left-shift), > (right-shift), |, &, ^, %, and # (exponentiation).
static int eval(char* str, uint64_t* val)
{
	int r = 0;
	uint64_t a;
	char *p, *s, *e, *t = str;
	for (; *t; ++t) { p = t; while (*p && isspace(*p)) ++p; if (t != p) strcpy(t, p); }
	p = str;
	*val = 0;

	while (*p)
	{
		if (sta == 0)
		{
			if (NULL != (s = eget(p)))
			{
				if ('(' == *s) { opsh(*s), p += strlen(s); continue; }
				if (s[0] == '0' && s[1] == 'x') a = strtoull(s + 2, &e, 16);
				else a = strtoull(s, &e, 10);
				apsh(a);
				p += strlen(s);
			}
			else return -1;
			sta = 1;
		}
		else
		{
			if (NULL == (s = oget(p))) return -1;
			if (strchr(sym, *s))
			{
				if (')' == *s) { if (0 > (r = peva())) return r; }
				else opsh(*s), sta = 0;
				p += strlen(s);
			}
			else return -1;
		}
	}

	while (1 < asp) 
		if (0 > (r = oeva())) 
			return r;

	if (!opp) return apop(val);
	else return -1;
}


static int peva() { int o; if (1 > par--) return -1; do if (0 > (o = oeva())) break; while ('(' != o); return o; }
static void opsh(char o) { if ('(' == o) ++par; ops[opp++] = o; }
static void apsh(uint64_t a) { arg[asp++] = a; }
static int apop(uint64_t* a) { *a = arg[--asp]; return (0 > asp) ? -1 : 0; }
static int opop(int* o) { if (!opp) return -1; *o = ops[--opp]; return 0; }
static char* oget(char* s) { *tok = *s; tok[1] = '\0'; return tok; }


static char* eget(char* s)
{
	char *p = s, *t = tok;
	while (*p)
	{
		if (strchr(sym, *p))
		{
			if (s == p) return oget(s);
			else break;
		}
		*t++ = *p++;
	}
	*t = '\0';
	return tok;
}


// Unsigned exponentiation.
static uint64_t upow(uint64_t b, uint64_t e)
{
	uint64_t r = UINT64_C(1);
	while (e)
	{
		if (e & UINT64_C(1)) r *= b;
		e >>= 1;
		b *= b;
	}
	return r;
}


// Eval operators.
static int oeva()
{
	uint64_t a, b;
	int o;
	if (opop(&o) == -1) return -1;
	apop(&a);
	apop(&b);
	switch (o)
	{
	case '+': apsh(b + a); break;
	case '-': apsh(b - a); break;
	case '*': apsh(b * a); break;
	case '/': if (a && b) apsh(b / a); else return -1; break;
	case '<': apsh(b << a); break;
	case '>': apsh(b >> a); break;
	case '|': apsh(b | a); break;
	case '&': apsh(b & a); break;
	case '^': apsh(b ^ a); break;
	case '%':  if (a && b) apsh(b % a); else return -1; break;
	case '#':  apsh(upow(b, a)); break;
	case '(': asp += 2; break;
	default: return -1;
	}
	if (asp < 1) return -1;
	return o;
}

